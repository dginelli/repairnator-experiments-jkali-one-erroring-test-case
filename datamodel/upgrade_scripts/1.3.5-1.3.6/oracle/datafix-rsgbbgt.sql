-- vervangt de (ongeldige) null geometrie door een null waarde in alle tabellen met geometrie
-- hierna worden de ruimtelijke indexen te ververst
--
-- select 'UPDATE ' || TABLE_NAME || ' c SET ' || COLUMN_NAME || ' = null' ||  ' WHERE c.'||COLUMN_NAME||'.GET_GTYPE() IS NULL;' as fix from user_sdo_geom_metadata;
-- 
UPDATE BAK c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE BAK c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE BEGROEID_TERREINDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE BEGROEID_TERREINDEEL c SET KRUINLIJN = null WHERE c.KRUINLIJN.GET_GTYPE() IS NULL;
UPDATE BEGROEID_TERREINDEEL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE BORD c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE BORD c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE FUNCTIONEELGEBIED c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE GEBOUW_INSTALLATIE c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE GEBOUW_INSTALLATIE c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE INSTALLATIE c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE INSTALLATIE c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE KAST c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE KAST c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE KUNSTWERKDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE MAST c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE MAST c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE ONBEGROEID_TERREINDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE ONBEGROEID_TERREINDEEL c SET KRUINLIJN = null WHERE c.KRUINLIJN.GET_GTYPE() IS NULL;
UPDATE ONDERSTEUNEND_WATERDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE ONDERSTEUNEND_WEGDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE ONDERSTEUNEND_WEGDEEL c SET KRUINLIJN = null WHERE c.KRUINLIJN.GET_GTYPE() IS NULL;
UPDATE ONDERSTEUNEND_WEGDEEL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE ONGECLASSIFICEERDOBJECT c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE OPENBARERUIMTELABEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE OPENBARERUIMTELABEL c SET OPRNM_POS_2_PUNT = null WHERE c.OPRNM_POS_2_PUNT.GET_GTYPE() IS NULL;
UPDATE OPENBARERUIMTELABEL c SET OPRNM_POS_3_PUNT = null WHERE c.OPRNM_POS_3_PUNT.GET_GTYPE() IS NULL;
UPDATE OVERBRUGGINGSDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE OVERBRUGGINGSDEEL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE OVERIGE_SCHEIDING c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE OVERIG_BOUWWERK c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE PAAL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE PAAL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE PAND c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_1_POS_1_PNT = null WHERE c.NRAR_1_POS_1_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_1_POS_2_PNT = null WHERE c.NRAR_1_POS_2_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_1_POS_3_PNT = null WHERE c.NRAR_1_POS_3_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_2_POS_1_PNT = null WHERE c.NRAR_2_POS_1_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_2_POS_2_PNT = null WHERE c.NRAR_2_POS_2_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_2_POS_3_PNT = null WHERE c.NRAR_2_POS_3_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_3_POS_1_PNT = null WHERE c.NRAR_3_POS_1_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_3_POS_2_PNT = null WHERE c.NRAR_3_POS_2_PNT.GET_GTYPE() IS NULL;
UPDATE PAND c SET NRAR_3_POS_3_PNT = null WHERE c.NRAR_3_POS_3_PNT.GET_GTYPE() IS NULL;
UPDATE PUT c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE PUT c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE SCHEIDING c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE SENSOR c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE SENSOR c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE SPOOR c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE SPOOR c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE STRAATMEUBILAIR c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE STRAATMEUBILAIR c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE TUNNELDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE TUNNELDEEL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE VEGETATIEOBJECT c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE VEGETATIEOBJECT c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE WATERDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE WATERINRICHTINGSELEMENT c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE WATERINRICHTINGSELEMENT c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE WEGDEEL c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE WEGDEEL c SET KRUINLIJN = null WHERE c.KRUINLIJN.GET_GTYPE() IS NULL;
UPDATE WEGDEEL c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;
UPDATE WEGINRICHTINGSELEMENT c SET GEOM2D = null WHERE c.GEOM2D.GET_GTYPE() IS NULL;
UPDATE WEGINRICHTINGSELEMENT c SET LOD0GEOM = null WHERE c.LOD0GEOM.GET_GTYPE() IS NULL;

-- select 'ALTER INDEX ' || INDEX_NAME || ' rebuild;' as rebuildidx from USER_SDO_INDEX_INFO;
ALTER INDEX PAND_GEOM2D_IDX rebuild;
ALTER INDEX PAND_NRAR_1_POS_1_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_1_POS_2_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_1_POS_3_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_2_POS_1_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_2_POS_2_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_2_POS_3_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_3_POS_1_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_3_POS_2_PNT_IDX rebuild;
ALTER INDEX PAND_NRAR_3_POS_3_PNT_IDX rebuild;
ALTER INDEX WEGDEEL_GEOM2D_IDX rebuild;
ALTER INDEX WEGDEEL_LOD0GEOM_IDX rebuild;
ALTER INDEX WEGDEEL_KRUINLIJN_IDX rebuild;
ALTER INDEX WATERINRICHTINGSELEMENT_LO_IDX rebuild;
ALTER INDEX WATERINRICHTINGSELEMENT_GE_IDX rebuild;
ALTER INDEX TUNNELDEEL_GEOM2D_IDX rebuild;
ALTER INDEX TUNNELDEEL_LOD0GEOM_IDX rebuild;
ALTER INDEX VEGETATIEOBJECT_GEOM2D_IDX rebuild;
ALTER INDEX VEGETATIEOBJECT_LOD0GEOM_IDX rebuild;
ALTER INDEX WEGINRICHTINGSELEMENT_GEOM_IDX rebuild;
ALTER INDEX WEGINRICHTINGSELEMENT_LOD0_IDX rebuild;
ALTER INDEX SPOOR_GEOM2D_IDX rebuild;
ALTER INDEX SPOOR_LOD0GEOM_IDX rebuild;
ALTER INDEX BEGROEID_TERREINDEEL_GEOM2_IDX rebuild;
ALTER INDEX BEGROEID_TERREINDEEL_LOD0G_IDX rebuild;
ALTER INDEX BEGROEID_TERREINDEEL_KRUIN_IDX rebuild;
ALTER INDEX BAK_GEOM2D_IDX rebuild;
ALTER INDEX BAK_LOD0GEOM_IDX rebuild;
ALTER INDEX ODRSTEUN_WEGDEEL_GEOM2D_IDX rebuild;
ALTER INDEX ODRSTEUN_WEGDEEL_LOD0GEOM_IDX rebuild;
ALTER INDEX ODRSTEUN_WEGDEEL_KRUINLIJN_IDX rebuild;
ALTER INDEX ODRSTEUN_WATERDEEL_GEOM2D_IDX rebuild;
ALTER INDEX STRAATMEUBILAIR_GEOM2D_IDX rebuild;
ALTER INDEX STRAATMEUBILAIR_LOD0GEOM_IDX rebuild;
ALTER INDEX OVERBRUGGINGSDEEL_GEOM2D_IDX rebuild;
ALTER INDEX OVERBRUGGINGSDEEL_LOD0GEOM_IDX rebuild;
ALTER INDEX ONBEGROEID_TERREINDEEL_GEO_IDX rebuild;
ALTER INDEX ONBEGROEID_TERREINDEEL_KRU_IDX rebuild;
ALTER INDEX KUNSTWERKDEEL_GEOM2D_IDX rebuild;
ALTER INDEX WATERDEEL_GEOM2D_IDX rebuild;
ALTER INDEX OCLASOBJECT_GEOM2D_IDX rebuild;
ALTER INDEX OVERIG_BOUWWERK_GEOM2D_IDX rebuild;
ALTER INDEX SCHEIDING_GEOM2D_IDX rebuild;
ALTER INDEX OVERIGE_SCHEIDING_GEOM2D_IDX rebuild;
ALTER INDEX OPRLBL_GEOM2D_IDX rebuild;
ALTER INDEX OPRLBL_OPRNM_POS_2_PUNT_IDX rebuild;
ALTER INDEX OPRLBL_OPRNM_POS_3_PUNT_IDX rebuild;
ALTER INDEX SENSOR_GEOM2D_IDX rebuild;
ALTER INDEX SENSOR_LOD0GEOM_IDX rebuild;
ALTER INDEX PUT_GEOM2D_IDX rebuild;
ALTER INDEX PUT_LOD0GEOM_IDX rebuild;
ALTER INDEX PAAL_GEOM2D_IDX rebuild;
ALTER INDEX PAAL_LOD0GEOM_IDX rebuild;
ALTER INDEX MAST_GEOM2D_IDX rebuild;
ALTER INDEX MAST_LOD0GEOM_IDX rebuild;
ALTER INDEX KAST_GEOM2D_IDX rebuild;
ALTER INDEX KAST_LOD0GEOM_IDX rebuild;
ALTER INDEX INSTALLATIE_GEOM2D_IDX rebuild;
ALTER INDEX INSTALLATIE_LOD0GEOM_IDX rebuild;
ALTER INDEX GEBOUW_INSTALLATIE_GEOM2D_IDX rebuild;
ALTER INDEX GEBOUW_INSTALLATIE_LOD0GEO_IDX rebuild;
ALTER INDEX FUNCTIONEELGEBIED_GEOM2D_IDX rebuild;
ALTER INDEX BORD_GEOM2D_IDX rebuild;
ALTER INDEX BORD_LOD0GEOM_IDX rebuild;
