sudo: required

cache:
  directories:
    - $HOME/.m2

language: java
jdk: oraclejdk8

services:
  - docker

env:
  global:
    - secure: vbFHahEb6q6pKnzcF66B2XDK84lA8camxYrb2fh2Es3AVdO2k/9f3mREBvgjqDrsvHqm8GDG7NO5Q6C/pHs3VZRNQGaKZQx4J+uZv5nplFAgrB5Sk7BUcJF2qRgNWq6Xi/pBVG3dFtAdyyvt0krSltXA7K0ppySBzPQjwtZZRAFG2PUo73Z8z2wgPU41zTAnXhtiedU178C/frfzG1nn69rt5WiXFAlaPeA97yTaU5FtfZ3uXvDB7g+HVHORZRn4EhAGEfQ/M6xmgYvLo4UJUdq/BthtU90b39ADaXp7o+7p3Wke4iN2BPNib81jdb2IAp4x4Y7YWgvt4trZ43hKvZj5iUdf98sJAKMXR0BsEpvtG65aLnqsSHl4EdZoMz/Po1o5myusrqhVoA0JbqwYJPjg9n9VEyKIZ/8LvYn50wDufoMkHZqQIA5r4xOtuGHWhe8+jwgGG3WBvyKVQsgZSis+SUtnG8VblCHHsz6OibSXuyMRm+bra+VwBjU3uC/RryTuwjuz1QFHvmJz3UDH6xkp2AhFzSY5mitKW3iVxsad4lZaDJzYZ3jCD2qqjXZwBGVFPtyxnd1/fpH/WCZtkebhUki7eDKNdXmKA4x0273EES3vwXWcuQscXFbmvTvb9GcSUY2H59CxBKMoFmLFWGlZx6Eh0pQq9FSW7ek+GJk=
    - secure: qjPH+VdMsyUuibVLQeSClq//M48Gbmb9xO6DtoCSqMIwDkLsN+QnsXgHDWgB1xj6iHIfqceZDZ2ZE5jF/VfLoTOjG8dqSnfa4MnQZtgnAufph9x8YLc8ipdmAdcBbjzWGFqjLEitNXoBzV7swjeY7d6+EDjy40IrVhUUSer51PwDU1b+AEAp5c3ivpjNc2N3vHnEKjx9KUjwMtQteLIhceB8pPHO4tC4Agd6k+v5hsgL4/E27h0gIM5usnzx/7eINzB3LdpPmHyB6OMfQgG/GPexh7GP8l1alKH7ZsHNZW+ccUCm2paxF2GrzqlhmK+J1B5MG2ReTiIT7U1pAbS/sU/Aj2uuXux5zFtbtvfumLNNt5ik0BCIB+DCbx/3Dde+NEruthj7+RJNhUIP/eC+9oVZf93jttRnlNyUvphF9FiQkgaA0wj1Xbj0Et5pb5+O+MScP94GIUQvfCYKkDQyIVmTHLeR+Vde6qaIhDNIDIsd32KqenY2HqMcttKQcfashf6bucgQ6VUL8q/861NUk/2f+TK/wTSygfIEnZWHsyU+0c7+pnZg0JsGwaD+R17116KMM4u7tamGFSGBq5xtFWm6J9ClDk3L+HE2ltDiAQ9jEq1b6yPC93pArDrTweL31qRayxDWwiHlrnRfViTXjfAkLOo+1GqoT33V4w5Ke6c=
    - COMMIT=${TRAVIS_COMMIT::7}

before_install:
  - echo 'before_install phase'
  - chmod +x mvnw

#install: ./mvnw clean install -DskipTests

before_script:
  - echo 'before_script phase'
  - docker build -t test-service .

after_failure:
  - echo 'test failed'

after_success:
  - docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"

  - export TEST=leonardobonacci/test
  - docker build -t $TEST:$COMMIT .
  - docker tag $TEST:$COMMIT $TEST:one
  - docker push $TEST
